
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bib Short Damage Poll</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #fefefe;
    }

    h1 {
      margin: 1.5em 0 1em;
      font-size: 1.8em;
    }

    svg {
      width: 100%;
      max-width: 1200px;
      height: auto;
    }

    .zone {
      fill: #cc3333;
      fill-opacity: 0;
      stroke: #00aa66;
      stroke-width: 1;
      cursor: pointer;
      transition: fill-opacity 0.2s ease;
      pointer-events: visiblePainted;
      -webkit-tap-highlight-color: transparent;
    }

    .zone:hover {
      fill-opacity: 0.2;
    }

    .zone.active {
      fill: #cc3333;
      fill-opacity: 0.4;
    }

    .zone:not(.active) {
      fill-opacity: 0;  /* ✅ Force opacity reset */
    }

    .zone:focus,
    .zone:active {
    outline: none;
    fill-opacity: 0;
    }

    svg {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
    }

    #save-btn {
      margin-top: 2em;
      padding: 12px 24px;
      font-size: 1.1em;
      background-color: #00aa66;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    #save-btn:hover {
      background-color: #008a55;
    }

    .popup {
  display: none;
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  padding: 12px 24px;
  border-radius: 6px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  font-size: 16px;
  z-index: 1000;
}

#confirmation {
  background: #00aa66;
  color: white;
}

#already-recorded {
  background: #cc3333;
  color: white;
}

 #limit-reached {
 background: #cc3333;
 color: white;
 }
    
    .popup.show {
  display: block;
  opacity: 1;
  pointer-events: auto;
}
    
  </style>
</head>
<body>

  <h1>Where have your bibs been damaged, crash or otherwise? 
  <br>Select all that apply, then click "Save".
  <br>You can click "clear", and submit up to three times!
  </h1>

  <svg viewBox="0 0 1536 1024" xmlns="http://www.w3.org/2000/svg">
    <image href="bibdamage2.png" x="0" y="0" width="1536" height="1024" />
<path id="R1" d="M 75.832 604.225 L 158.184 604.341 L 160 623.324 L 168.518 644.201 L 180.959 664.792 L 97.967 668.554 L 85.944 639.834 L 75.832 604.225 Z" class="zone" onclick="this.classList.toggle('active'); requestAnimationFrame(() => this.style.transform = 'scale(1)');" />
<path id="R2" d="M 122.012 730.67 L 203.497 710.633 L 193.396 686.108 L 181.445 665.977 L 98.635 669.89 L 113.997 705.958 L 122.012 730.67 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="R3" d="M 122.492 732.111 L 203.768 711.875 L 214.388 740.518 L 222.85 771.755 L 228.022 804.743 L 134.034 810.086 L 129.342 766.909 L 122.492 732.111 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="R4" d="M 134.376 811.488 L 228.911 806.316 L 231.55 842.88 L 230.678 879.427 L 139.24 881.757 L 134.376 811.488 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="R5" d="M 139.72 883.452 L 138.71 952.418 L 218.192 952.418 L 230.214 880.951 L 139.72 883.452 Z" class="zone" onclick="this.classList.toggle('active')" />


<path id="F1" d="M 397.506 612.101 L 474.526 612.101 L 464.542 635.398 L 454.082 659.169 L 449.804 670.104 L 382.768 668.678 L 389.9 638.726 L 397.506 612.101 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F2" d="M 382.57 669.89 L 449.435 671.316 L 442.672 691.498 C 442.672 691.498 437.52 713.276 437.995 713.276 C 438.47 713.276 376.389 709.287 376.389 709.287 C 376.389 709.287 382.094 670.841 382.57 669.89 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F3" d="M 376.447 710.607 C 376.447 710.607 437.122 714.61 437.598 714.61 C 438.074 714.61 436.016 738.566 436.016 738.566 L 436.477 768.071 L 441.246 796.568 L 443.914 808.56 C 443.914 808.56 398.365 808.85 398.365 808.375 C 398.365 807.9 392.03 766.524 392.03 766.524 L 384.408 732.754 L 376.447 710.607 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F4" d="M 398.457 809.88 L 444.098 809.88 C 444.098 809.88 450.754 836.979 451.23 836.979 C 451.706 836.979 458.837 861.702 458.837 861.702 C 458.837 861.702 465.968 880.719 465.968 880.243 C 465.968 879.767 402.736 880.243 402.736 880.243 L 401.645 842.117 L 398.457 809.88 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F5" d="M 402.644 881.578 C 402.644 881.578 407.674 952.692 408.15 952.217 C 408.626 951.742 467.409 952.295 467.409 952.295 L 466.55 881.378 L 402.644 881.578 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F6" d="M 475.821 611.818 L 463.872 640.694 L 451.26 670.565 L 540.872 671.97 L 540.613 612.636 L 475.821 611.818 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F7" d="M 439.807 713.196 L 506.688 726.989 L 517.641 722.342 L 528.874 719.406 L 540.664 718.869 C 540.664 718.869 540.616 673.831 540.948 673.831 C 541.28 673.831 450.649 672.48 450.649 672.48 L 447.431 681.672 L 442.962 695.126 L 439.807 713.196 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F8" d="M 439.288 714.659 L 506.833 728.753 L 501.897 733.914 L 497.857 741.768 L 494.491 750.295 L 491.798 760.169 L 491.35 773.633 C 491.35 773.633 496.287 785.077 496.511 785.077 C 496.735 785.077 502.121 792.258 502.346 792.258 C 502.571 792.258 509.077 798.99 509.077 798.99 C 509.077 798.99 521.195 810.659 521.195 810.884 C 521.195 811.109 445.572 807.742 445.572 807.742 L 441.084 785.526 L 437.942 765.106 L 437.493 741.319 C 437.493 741.319 439.737 714.659 439.288 714.659 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F9" d="M 446.062 809.39 L 523.027 812.499 C 523.027 812.499 510.594 879.991 510.594 879.793 C 510.594 879.595 467.771 879.596 467.771 879.596 L 457.509 850.192 L 449.813 824.143 L 446.062 809.39 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F10" d="M 468.757 951.759 L 496.188 951.758 C 496.188 951.758 509.608 881.701 509.805 881.701 C 510.002 881.701 468.166 881.504 468.363 881.504 C 468.56 881.504 468.955 951.167 468.757 951.759 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F11" d="M 525.626 806.078 L 513.559 793.663 L 503.067 782.821 C 503.067 782.821 498.87 773.203 499.045 773.203 C 499.22 773.203 500.619 759.388 500.619 759.388 L 504.816 746.273 L 509.887 737.039 L 521.648 729.065 L 536.485 726.695 L 551.681 727.562 L 563.398 730.01 L 572.875 737.216 L 579.66 748.478 L 582.633 762.011 L 583.682 774.077 L 579.66 782.471 L 569.168 793.663 L 555.878 806.078 L 557.547 811.64 L 576.513 794.537 L 586.655 783.17 L 589.978 772.503 L 587.634 751.41 L 581.584 737.529 L 573.19 728.611 L 558.501 722.315 L 540.839 720.916 L 525.8 721.791 L 512.335 726.512 L 504.466 733.507 L 498.521 743.3 L 493.974 758.164 L 492.925 773.203 L 498.346 785.094 L 512.51 799.958 L 524.052 811.324 L 525.626 806.078 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F12" d="M 525.459 803.254 L 529.947 778.345 L 540.718 770.94 C 540.718 770.94 551.265 777.672 551.489 777.672 C 551.713 777.672 555.753 803.029 555.753 803.029 L 563.831 796.971 L 577.969 781.936 L 582.008 774.306 L 580.437 757.252 L 577.296 746.705 L 571.012 737.504 L 562.261 730.772 L 551.489 728.977 L 538.923 728.079 L 531.518 728.528 C 531.518 728.528 522.317 730.323 522.542 730.323 C 522.767 730.323 512.219 736.831 512.219 736.831 L 507.731 743.563 L 503.692 752.315 L 501.897 760.842 L 500.326 772.96 L 504.141 781.711 L 510.199 787.995 L 525.459 803.254 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F13" d="M 605.713 611.818 L 617.662 640.694 L 630.274 670.565 L 542.845 672.278 L 542.181 612.636 L 605.713 611.818 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F14" d="M 642.874 712.868 L 575.174 727.481 L 563.893 722.342 L 552.66 719.406 L 542.593 718.889 C 542.593 718.889 542.949 673.831 542.617 673.831 C 542.285 673.831 630.885 672.48 630.885 672.48 L 634.103 681.672 L 638.572 695.126 L 642.874 712.868 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F15" d="M 643.232 714.167 L 575.687 728.753 L 580.623 733.914 L 584.663 741.768 L 588.029 750.295 L 590.722 760.169 L 591.17 773.633 C 591.17 773.633 586.233 785.077 586.009 785.077 C 585.785 785.077 580.399 792.258 580.174 792.258 C 579.949 792.258 573.443 798.99 573.443 798.99 C 573.443 798.99 561.325 810.659 561.325 810.884 C 561.325 811.109 636.948 807.742 636.948 807.742 L 641.436 785.526 L 644.578 765.106 L 645.027 741.319 C 645.027 741.319 642.783 714.167 643.232 714.167 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F16" d="M 636.458 809.391 L 559.493 812.5 C 559.493 812.5 571.926 879.992 571.926 879.794 C 571.926 879.596 614.749 879.597 614.749 879.597 L 625.011 850.193 L 632.707 824.144 L 636.458 809.391 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F17" d="M 613.763 951.759 L 586.332 951.758 C 586.332 951.758 572.912 881.701 572.715 881.701 C 572.518 881.701 614.354 881.504 614.157 881.504 C 613.96 881.504 613.565 951.167 613.763 951.759 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F18" d="M 685.409 612.101 L 608.389 612.101 L 618.373 635.398 L 628.833 659.169 L 633.111 670.104 L 700.147 668.678 L 693.015 638.726 L 685.409 612.101 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F19" d="M 700.345 669.89 L 633.48 671.316 L 640.243 691.498 C 640.243 691.498 645.395 713.276 644.92 713.276 C 644.445 713.276 706.526 709.287 706.526 709.287 C 706.526 709.287 700.821 670.841 700.345 669.89 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F20" d="M 706.468 710.607 C 706.468 710.607 645.793 714.61 645.317 714.61 C 644.841 714.61 646.899 738.566 646.899 738.566 L 646.438 768.071 L 641.669 796.568 L 639.001 808.56 C 639.001 808.56 684.55 808.85 684.55 808.375 C 684.55 807.9 690.885 766.524 690.885 766.524 L 698.507 732.754 L 706.468 710.607 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F21" d="M 684.458 809.88 L 638.817 809.88 C 638.817 809.88 632.161 836.979 631.685 836.979 C 631.209 836.979 624.078 861.702 624.078 861.702 C 624.078 861.702 616.947 880.719 616.947 880.243 C 616.947 879.767 680.179 880.243 680.179 880.243 L 681.27 842.117 L 684.458 809.88 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="F22" d="M 680.271 881.578 C 680.271 881.578 675.241 952.692 674.765 952.217 C 674.289 951.742 615.506 952.295 615.506 952.295 L 616.365 881.378 L 680.271 881.578 Z" class="zone" onclick="this.classList.toggle('active')" />


<path id="L1" d="M 1006.55 604.225 L 924.198 604.341 L 922.382 623.324 L 913.864 644.201 L 901.423 664.792 L 984.415 668.554 L 996.438 639.834 L 1006.55 604.225 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="L2" d="M 960.37 730.67 L 878.885 710.633 L 888.986 686.108 L 900.937 665.977 L 983.747 669.89 L 968.385 705.958 L 960.37 730.67 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="L3" d="M 959.89 732.111 L 878.614 711.875 L 867.994 740.518 L 859.532 771.755 L 854.36 804.743 L 948.348 810.086 L 953.04 766.909 L 959.89 732.111 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="L4" d="M 948.006 811.488 L 853.471 806.316 L 850.832 842.88 L 851.704 879.427 L 943.142 881.757 L 948.006 811.488 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="L5" d="M 942.662 883.452 L 943.672 952.418 L 864.19 952.418 L 852.168 880.951 L 942.662 883.452 Z" class="zone" onclick="this.classList.toggle('active')" />


<path id="B1" d="M 1308.257 661.322 L 1307.872 609.373 L 1277.532 609.106 L 1270.817 623.341 L 1263.297 637.039 L 1255.776 649.931 L 1247.987 661.749 L 1308.257 661.322 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B2" d="M 1198.44 752.298 L 1238.55 753.108 L 1236.119 740.548 L 1237.334 725.153 L 1243.817 711.783 L 1253.135 697.197 L 1263.669 688.284 C 1263.669 688.284 1274.608 685.043 1275.014 685.448 C 1275.42 685.853 1288.789 689.094 1288.789 689.094 L 1308.094 697.873 L 1307.822 663.026 C 1307.822 663.026 1246.653 663.164 1247.058 663.164 C 1247.463 663.164 1233.283 685.853 1233.283 685.853 L 1219.103 707.326 L 1205.328 732.04 L 1198.44 752.298 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B3" d="M 1198.236 753.628 L 1195.785 769.843 C 1195.785 769.843 1193.334 787.944 1193.522 787.944 C 1193.71 787.944 1190.883 807.175 1190.883 806.987 C 1190.883 806.799 1189.563 823.39 1189.563 823.39 L 1289.115 824.71 L 1291.377 812.832 L 1279.688 802.084 L 1268.186 789.64 L 1256.685 777.574 L 1246.315 764.752 L 1238.584 754.383 L 1198.236 753.628 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B4" d="M 1186.735 881.085 L 1278.556 881.462 L 1288.738 825.841 L 1189.94 824.333 L 1188.055 850.352 L 1186.735 881.085 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B5" d="M 1186.735 882.468 L 1186.735 913.389 C 1186.735 913.389 1187.678 952.984 1187.678 952.795 C 1187.678 952.606 1264.227 952.795 1264.038 952.795 C 1263.849 952.795 1277.425 882.656 1277.425 882.656 L 1186.735 882.468 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B6" d="M 1293.172 805.054 C 1293.172 805.054 1274.408 784.717 1274.513 784.717 C 1274.618 784.717 1256.273 764.485 1256.377 764.485 C 1256.481 764.485 1245.895 749.39 1245.895 749.39 L 1242.959 737.649 C 1242.959 737.649 1243.693 725.698 1243.798 725.698 C 1243.903 725.698 1248.62 715.845 1248.725 715.845 C 1248.83 715.845 1254.071 707.039 1254.281 707.039 C 1254.491 707.039 1260.675 699.806 1260.99 699.806 C 1261.305 699.806 1268.814 694.212 1269.129 694.107 C 1269.444 694.002 1278.048 694.012 1278.048 694.012 C 1278.048 694.012 1291.705 698.882 1291.81 698.882 C 1291.915 698.882 1308.372 706.829 1308.582 706.934 C 1308.792 707.039 1323.057 700.502 1323.057 700.502 C 1323.057 700.502 1334.999 696.137 1335.313 696.137 C 1335.627 696.137 1344.643 693.411 1344.643 693.411 L 1351.724 695.508 L 1358.927 701.235 C 1358.927 701.235 1366.409 710.298 1366.619 710.298 C 1366.829 710.298 1372.699 721.448 1372.699 721.448 L 1375.043 727.051 L 1375.33 740.67 L 1369.068 755.784 C 1369.068 755.784 1357.851 769.622 1357.851 769.831 C 1357.851 770.04 1347.997 781.048 1347.893 781.048 C 1347.789 781.048 1325.517 804.691 1325.412 804.691 C 1325.307 804.691 1326.689 811.619 1326.689 811.619 L 1355.231 782.515 L 1372.318 761.55 C 1372.318 761.55 1378.007 753.259 1378.112 753.259 C 1378.217 753.259 1380.962 738.888 1380.962 738.888 L 1379.913 726.346 L 1374.414 713.834 L 1368.229 704.009 L 1361.93 695.88 L 1353.658 689.428 L 1344.119 687.045 L 1330.768 690.362 L 1323.354 693.544 L 1307.848 700.225 L 1300.301 696.032 C 1300.301 696.032 1288.455 690.476 1288.56 690.476 C 1288.665 690.476 1279.649 688.17 1279.649 688.17 L 1273.36 687.226 C 1273.36 687.226 1264.659 689.218 1264.764 689.218 C 1264.869 689.218 1258.369 694.355 1258.369 694.355 L 1253.757 698.443 C 1253.757 698.443 1249.02 706.153 1249.125 706.153 C 1249.23 706.153 1244.427 713.329 1244.427 713.329 L 1239.014 725.069 C 1239.014 725.069 1237.413 739.878 1237.518 739.878 C 1237.623 739.878 1239.605 753.059 1239.605 753.059 L 1242.016 756.833 C 1242.016 756.833 1251.765 769.517 1251.765 769.622 C 1251.765 769.727 1258.684 778.008 1258.684 778.008 L 1269.271 789.225 L 1279.649 800.336 L 1291.914 811.448 C 1291.914 811.448 1293.172 804.844 1293.172 805.054 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B7" d="M 1293.3 803.092 L 1297.842 778.564 L 1308.592 770.539 L 1308.2 708.656 L 1296.631 702.859 C 1296.631 702.859 1284.821 698.316 1285.124 698.316 C 1285.427 698.316 1276.948 695.44 1276.948 695.44 C 1276.948 695.44 1269.529 695.742 1269.68 695.591 C 1269.831 695.44 1262.412 700.588 1262.412 700.436 C 1262.412 700.284 1255.447 707.855 1255.599 707.704 C 1255.751 707.553 1250.148 715.577 1250.299 715.426 C 1250.45 715.275 1246.363 723.602 1246.514 723.602 C 1246.665 723.602 1244.697 726.63 1244.849 726.479 C 1245.001 726.328 1244.243 736.623 1244.394 736.623 C 1244.545 736.623 1246.968 748.282 1247.12 748.282 C 1247.272 748.282 1253.176 757.518 1253.176 757.518 C 1253.176 757.518 1258.93 765.391 1259.081 765.391 C 1259.232 765.391 1269.831 777.807 1270.134 777.958 C 1270.437 778.109 1293.149 803.395 1293.3 803.092 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B8" d="M 1325.03 803.092 L 1320.49 778.564 L 1309.74 770.539 L 1309.86 708.522 L 1321.7 702.859 C 1321.7 702.859 1333.51 698.316 1333.21 698.316 C 1332.9 698.316 1341.38 695.44 1341.38 695.44 C 1341.38 695.44 1348.8 695.742 1348.65 695.591 C 1348.5 695.44 1355.92 700.588 1355.92 700.436 C 1355.92 700.284 1362.88 707.855 1362.73 707.704 C 1362.58 707.553 1368.18 715.577 1368.03 715.426 C 1367.88 715.275 1371.97 723.602 1371.81 723.602 C 1371.66 723.602 1373.63 726.63 1373.48 726.479 C 1373.33 726.328 1374.09 736.623 1373.93 736.623 C 1373.78 736.623 1371.36 748.282 1371.21 748.282 C 1371.06 748.282 1365.15 757.518 1365.15 757.518 C 1365.15 757.518 1359.4 765.391 1359.25 765.391 C 1359.1 765.391 1348.5 777.807 1348.2 777.958 C 1347.89 778.109 1325.18 803.395 1325.03 803.092 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B9" d="M 1309.93 661.322 L 1309.78 609.239 L 1340.79 609.106 L 1347.51 623.341 L 1355.03 637.039 L 1362.55 649.931 L 1370.34 661.749 L 1309.93 661.322 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B10" d="M 1419.89 752.298 L 1379.78 753.108 L 1382.21 740.548 L 1380.99 725.153 L 1374.51 711.783 L 1365.19 697.197 L 1354.66 688.284 C 1354.66 688.284 1343.72 685.043 1343.32 685.448 C 1342.91 685.853 1329.54 689.094 1329.54 689.094 L 1309.57 698.007 L 1309.44 662.892 C 1309.44 662.892 1371.68 663.164 1371.27 663.164 C 1370.87 663.164 1385.05 685.853 1385.05 685.853 L 1399.23 707.326 L 1413 732.04 L 1419.89 752.298 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B11" d="M 1420.09 753.628 L 1422.54 769.843 C 1422.54 769.843 1424.99 787.944 1424.8 787.944 C 1424.61 787.944 1427.44 807.175 1427.44 806.987 C 1427.44 806.799 1428.76 823.39 1428.76 823.39 L 1329.21 824.71 L 1326.95 812.832 L 1338.63 802.084 L 1350.14 789.64 L 1361.64 777.574 L 1372.01 764.752 L 1379.74 754.383 L 1420.09 753.628 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B12" d="M 1431.59 881.085 L 1339.77 881.462 L 1329.59 825.841 L 1428.39 824.333 L 1430.27 850.352 L 1431.59 881.085 Z" class="zone" onclick="this.classList.toggle('active')" />
<path id="B13" d="M 1431.59 882.468 L 1431.59 913.389 C 1431.59 913.389 1430.64 952.984 1430.64 952.795 C 1430.64 952.606 1354.1 952.795 1354.29 952.795 C 1354.47 952.795 1340.9 882.656 1340.9 882.656 L 1431.59 882.468 Z" class="zone" onclick="this.classList.toggle('active')" />

  </svg>

<div style="margin-top: 1.5em;">
  <input
    id="comment-box"
    type="text"
    maxlength="1000"
    placeholder="Optional: enter any additional comments or clarification"
    style="width: 80%; max-width: 600px; padding: 10px; font-size: 1em; border: 1px solid #ccc; border-radius: 5px;"
  />
</div>

  
<button id="clear-btn" style="margin-right: 12px;">Clear</button>
<button id="save-btn">Save</button>

<div id="confirmation" class="popup">✅ Response recorded!</div>
<div id="already-recorded" class="popup">⚠️ Response already recorded!</div>
<div id="limit-reached" class="popup">⚠️ Maximum submissions recorded</div>
  
<script>
  let userIP = "";

   fetch("https://api.ipify.org?format=json")
     .then(res => res.json())
     .then(data => {
       userIP = data.ip;
       console.log("Fetched IP:", userIP); // optional debug
     });
  
  // Save button functionality
  let hasSubmitted = false;

  document.getElementById("save-btn").addEventListener("click", () => {
    if (hasSubmitted) {
    // 🟥 Show red warning popup
    console.log("Already submitted — showing warning popup");

// Send duplicate log to spreadsheet
    const formData = new URLSearchParams();
    formData.append("zones", "Duplicate Submission Attempted");
    formData.append("ip", userIP);
      
    fetch("https://script.google.com/macros/s/AKfycbzNSMpMrNYHPcfExevG0IIJN2CDOuyBD3jM6X6F6iwbcih64L2Uj65397LKnD2INpJy/exec", {
        method: "POST",
        mode: "no-cors",
        body: formData
      });
      
    const already = document.getElementById("already-recorded");
    already.style.display = "block";
    setTimeout(() => {
      already.style.display = "none";
    }, 4000);
    return;
  }
    
    const selectedZones = Array.from(document.querySelectorAll(".zone.active")).map(el => el.id);
    const formData = new URLSearchParams();
    formData.append("zones", selectedZones.join(","));
    formData.append("ip", userIP);

     const comment = document.getElementById("comment-box").value.trim();
      if (comment.length > 0) {
        console.log("Submitting comment:", comment);
        formData.append("comment", comment);
      }
      else {
          console.log("No Comment:", comment);
      }
    
    fetch("https://script.google.com/macros/s/AKfycbzNSMpMrNYHPcfExevG0IIJN2CDOuyBD3jM6X6F6iwbcih64L2Uj65397LKnD2INpJy/exec", {
  method: "POST",
  mode: "cors",
  headers: { "Accept": "text/plain" },
  body: formData
})
.then(response => response.text())
.then(text => {
  console.log("Server response:", text); // ✅ Debugging
  if (text.trim() === "LIMIT_REACHED") {
    const limitPopup = document.getElementById("limit-reached");
    limitPopup.classList.add("show");
    setTimeout(() => limitPopup.classList.remove("show"), 4000);
    return;
  }

  const confirmation = document.getElementById("confirmation");
  confirmation.style.display = "block";
  setTimeout(() => {
    confirmation.style.display = "none";
  }, 4000);

  hasSubmitted = true;
  document.getElementById("save-btn").style.opacity = "0.6";
  });
});

  // ✅ Clear button functionality
  document.getElementById("clear-btn").addEventListener("click", () => {
    document.querySelectorAll(".zone.active").forEach(el => el.classList.remove("active"));
    hasSubmitted = false;
    document.getElementById("save-btn").style.opacity = "1";
    document.getElementById("comment-box").value = "";

  });
</script>

</body>
</html>
